\chapter{Скінченностанова спряженість
лінійних  функцій на кільці цілих 2-адичних чисел1.}

%\section{Необхідні визначення допоміжні твердження}
%\subsection{Необхідні визначення}
Цей розділ присвячений відповіді на питання, чи спряжені в
$FAutT_2$ скінченостанові автомати максимального про-порядку, що
задаються лінійними функціями.
 Використані наступні позначення:


 $T_2$ - однорідне кореневе дерево валентності 2, координатизоване природнім чином,

$AutT_2$ - група автоморфізмів дерева $T_2$,

 $e$- нейтральний елемент групи $AutT_2$,

$FAutT_2$ - підгрупа скінченостанових автоматних підстановок в
$AutT_2$,

$Z_2$ - поле 2-адичних чисел.


 Детальніше опишемо $FAutT_2$.

 Дію автоморфізму $\alpha\in AutT_2$ на
 дереві $T_2$ можна закодувати наступним чином. Помітимо вершину
 $n$-того рівня 1-ю, якщо автоморфізм $\alpha$ переставляє вершини $(n+1)$-го
 рівня, суміжні з нею, і 0-м, якщо залишає ці вершини  на
 місці (вершиною $n$-того рівня називається вершина, що з'єднана з коренем $n$ ребрами).
 Таке представлення автоморфізму назвемо портретом.


 Далі розглядаються тільки піддерева, які ізоморфні $T_2$ з коренем в певній
 вершині, що не містять вершин попереднього для кореня рівня.
 Портрет автоморфізму індукує портрети на всіх таких піддеревах.
 Далі таки портрети будемо називати станами автоморфізму
 Якщо для автоморфізму $\alpha$ маємо скінчену кількість станів, то назвемо $\alpha$ скінченостановим. Множина
 скінченостанових автоморфізмів утворює групу $FAutT_2$.
  Автоморфізми, що переводять квазіперіодичні кінці в квазіперіодичні утворюють множину $QAutT_2$. Очевидно, $QAutT_2$
  є напівгрупою.

    Має місце наступне твердження
  \begin{theorem}$FAutT_2$ є
  власною підмножиною $QAutT_2$.
\end{theorem}
\begin{proof}
 Дійсно, якщо автоморфізм $\alpha$  переводить квазіперіодичний кінець $x$ в неперіодичний кінець $y$,
 то портрет автоморфізму $\alpha$ містить нескінчену кількість станів, які починаються у вершинах кінця $x$,
 оскільки в портреті автоморфізму $\alpha$ вершини квазіперіодичного кінця $x$ кодуються неперіодичною послідовністю
 двійкого 2-адичного розкладу кінця $y$.

  Далі, розглянемо автоморфізм $\beta$, який має наступний портрет: всі вершини деякого неперіодичного кінця $x$
 кодуються послідовністю двійкового 2-адичного розкладу кінця $x$, всі інші вершини 0-ми. Очевидно $\beta$
  належить $QAutT_2$, але не є
скінченостановим, оскільки
 містить нескінчену кількість станів, які починаються у вершинах кінця $x$. Тобто $FAutT_2$ є
  власною підмножиною $QAutT_2$.

   $QAutT_2$ не є групою. Дійсно, обернений автоморфізм до автоморфізму $\beta$ переводить квазіперіодичний
  кінець ...00000 в неперіодичний кінець $x$, тобто $\beta$ належить $QAutT_2$, а $\beta^{-1}$
   не належить $QAutT_2$.
\end{proof}


 Розглянемо праву та ліву вершини 1-го рівня. Вони є коренями двох
 піддерев, які назвемо відповідно правим та лівим. Запис
 $\alpha=(\beta,\gamma)$ означає, що автоморфізм $\alpha$ на ліве
 піддерево діє автоморфізмом $\beta$, на ліве
 піддерево діє автоморфізмом $\gamma$, вершини 1-го рівня
 залишає на місці. Запис
 $\alpha=(\beta,\gamma)\circ  \sigma$ означає, що автоморфізм $\alpha$ на ліве
 піддерево діє автоморфізмом $\beta$, на ліве
 піддерево діє автоморфізмом $\gamma$, вершини 1-го рівня
 міняє місцями. Автоморфізми $\beta$,$\gamma$ є станами автоморфізму $\alpha$.

Множення автоморфізмів відбувається наступним чином: $$
(\beta_1,\gamma_1)\circ (\beta_2,\gamma_2)=(\beta_1 \circ \beta_2
,\gamma_1 \circ \gamma_2 ) $$ $$(\beta_1,\gamma_1)\circ \sigma
\circ (\beta_2,\gamma_2)=(\beta_1 \circ \gamma_2 ,\gamma_1 \circ
\beta_2 ) \circ \sigma$$

 Поставимо  у відповідність автоморфізмам з $AutT_2$ функції $Z_2\rightarrow Z_2$.
 Нехай вершини $T_2$ занумеровано природним
 чином:для двох вершин $n+1$-го рівня, що з'єднані з однією вершиною $n$-го рівня, права вершина
  помічена $1$, ліва $0$.

  Поставимо  у відповідність кінцю $x$ з дерева $T_2$ 2-адичне число $\overline{x}$,
 двійковий запис якого співпадає з кодуванням
  $x$ в $T_2$. Означимо функцію $f_{\gamma}:Z_2\rightarrow Z_2$, що відповідає автоморфізму $\gamma$ наступним
  чином $f_{\gamma}(\overline{x})=x\circ\gamma$ ($\gamma_f$ відповідає $f$). Далі будемо ототожнювати $x$ та $\overline{x}$,
    $f_\gamma$ та $\gamma$. Добуток автоморфізмів $\alpha \circ  \beta$ ,будемо записувати як суперпозицію функцій
    $f_{\alpha}\circ  f_{\beta}$(першою діє ліва функція).

      Наприклад, adding machine, що задається автоматом  $\varepsilon=(e,\varepsilon)\circ  \sigma$
    відповідає функції $f_{\varepsilon}(x)=x+1$. Централізатор такої функції в $AutT_2$ складається
     з функцій $f(x)=x+p,p\in Z_2$(див.[3]), тобто з 2-адичних степенів $\varepsilon$, оскільки
     $$\varepsilon^p=\gamma_{x+1}^p=\gamma_{x+p}\  (\forall p\in Z_2)$$

     Множину обертовних елементів в кільці $K$ позначимо, як
      $K^{* }$.


      Множину $\{p=m/(2n+1)|m,n \in \mathbb{Z}\}$ позначимо, як
      $Z_2^{\mathbb{Q}}$.
     Вона складається з 2-адичних чисел, що мають період в двійковому запису.


     \begin{lemma} \label{ficen} $(x+p)\in FAutT_2\Leftrightarrow p\in Z_2^{\mathbb{Q}}.$
\end{lemma}
\begin{proof}
$\Rightarrow$ Автоморфізм $x+p:0\rightarrow p$. Скінченостановий
автоморфізм переводить квазіперіодичні кінці в квазіперіодичні.
Оскільки $...000$ - квазіперіодичний, то і $p$- квазіперіодичний,
тобто належить $Z_2^{\mathbb{Q}}$. $p$ як квазіперіодичне число
має наступний двійковий запис:
$$p=...a_{k+m}...a_{k+1}...a_{k+m}...a_{k+1}a_k...a_2a_1.$$
Натуральне число $a_{k+m}...a_{k+1}$ будемо називати періодом
числа $p$.

$p$ можна представити у вигляді:$$p=...0...01...0...01\cdot
2^k\cdot q+a_k...a_2a_1 \ \ \ (1)$$ де період $0...01$ складається
з m цифр, а $q=a_{k+m}...a_{k+1}$- період числа  $p$.



 $\Leftarrow $
 Нехай $\varepsilon=\gamma_{x+1}$, тобто $\varepsilon$ - adding machine. Автоморфізм
  $\varepsilon$ підноситься у 2-адичну
 степінь наступним чином:
$$\varepsilon^{2p}=(\varepsilon^p,\varepsilon^p),\varepsilon^{2p+1}=(\varepsilon^p,\varepsilon^{p+1})\circ \sigma
  \ \ \ (2)$$


 Згідно з $(1)$ $\varepsilon^{p}=(\varepsilon^{...01} \frac{0...01}{m})^{q*
2^{n}}\circ  \varepsilon^v$ де $q,m,v,n\in \mathbb{Z^+}$,$v$-
початок довжини $n$ двійкового запису числа $p$ до початку періода
$q$ довжини $m$.

Згідно з $(2)$ автоморфізм $\varepsilon^{...01}\frac{0...01}{m}$
містить $m$ станів вигляду
$(\varepsilon^{...01}\frac{0...01}{m})^{2^k},k\in
\{0,1,...,m-1\}$, та $m-1$ станів вигляду
$(\varepsilon^{...01}\frac{0...01}{m})^{2^k}\circ \varepsilon,k\in
\{1,...,m-1\}$ ,тобто містить $2m-1$ станів. Оскільки
$\varepsilon^{...01}\frac{0...01}{m}$ скінченостановий
автоморфізм, то і $\varepsilon^p$-скінченостановий, так як
$q,v,n\in \mathbb{Z^+}$.
\end{proof}
    \begin{lemma} \label{ficen} Автоморфізм $px\in FAutT_2\Leftrightarrow p\in (Z_2^{\mathbb{Q}})^*  .$
\end{lemma}
\begin{proof}
Автоморфізми $f_1(x)=(2k+1)x$ та $f_2(x)=(1/(2k+1))x$
скінченостанові одночасно, оскільки

$${f_1}={f_2}^{-1}$$
$${((2m+1)/(2k+1))x}={(2m+1)x}\circ  {(1/(2k+1))x}$$
$${-kx}={-x}\circ  {kx}$$ то достатньо довести, що
${-x}$ та ${(2t+1)x}$ - скінченостанові $\forall t\in
\mathbb{Z^+}$.

 ${(2t+1)x}$  містить тільки стани вигляду ${(2t+1)x+f}$ ,
де $f\in \{0,1,...,(2t+1)\}$. Дійсно

$${(2t+1)x}=({(2t+1)x},{(2t+1)x+t})$$
$${(2t+1)x+2f}=({(2t+1)x+f},{(2t+1)x+(k+f)
})$$
$${(2t+1)x+(2f+1)}=$$ $$=({(2t+1)x+f},{(2t+1)x+(t+f+1)
})\circ  \sigma$$

Якщо $f\leq t$, то $t+f\leq 2k,t+f+1\leq 2t+1$, тобто автоморфізм
${(2t+1)x}$  має не більше $2t+2$ станів.

 Далі $${-x}=({-x},{-x-1}) $$
 $${-x-1}=({-x-1},{-x-1})\circ  \sigma $$

 тобто ${-x}$ - автоморфізм з 2-ма станами.
\end{proof}
У рівнянні $\alpha ^{\chi}=\beta$ розв'язок, який переводить
...000 в ...000 позначимо, як $\chi_0$.



\begin{lemma} \label{ficen}Нехай $\varepsilon$ та $\alpha$ спряжені в $AutT_2$.
  Рівняння $\varepsilon^{\chi}=\alpha$ має розв'язок в $\chi\in FAutT_2$ тоді й тільки тоді,
   коли $\exists \chi_0 \in FAutT_2 $, такий, що $\varepsilon^{\chi_0}=\alpha \ (\chi_0:...000\rightarrow ...000)$.
\end{lemma}
\begin{proof}
$\Leftarrow$ \ $\chi=\chi_0$

$\Rightarrow$ Для розв'язку $\chi:0\rightarrow p,\chi \in FAutT_2$
обов'язково $p\in Z_2^{\mathbb{Q}}$, оскільки скінченостановий
автоморфізм переводить квазіперіодичні кінці в квазіперіодичні.
Тоді(за лем.1) $\varepsilon^{-p}$ - скінченостановий автоморфізм і
$\chi_0=\varepsilon^{-p}\circ  \chi:0\rightarrow 0$.

\end{proof}
\begin{lemma}
Всі $f(x)=ax+p,a \ (p\in (Z_2^{\mathbb{Q}})^*  )$ спряжені з
$f(x)=ax+1$  в $FAutT_2$.
\end{lemma}
\begin{proof}
Для рівняння $\alpha^{\chi}_{ax+1}={ax+p}, \chi_0=px$. Дійсно
$${p^{-1}x}\circ  (ax+1)\circ  {px}=$$ $$=(a(p^{-1}x)+1)\circ  {px}={p(a(p^{-1}x)+1)}={ax+p}$$
 Згідно з лемою 2 \ $\chi_0\in FAutT_2$.
\end{proof}
\begin{lemma}
$f(x)=p_1x+p_2 \in FAutT_2 \Leftrightarrow p_1,p_2 \in
Z_2^{\mathbb{Q}}  $
\end{lemma}
\begin{proof}
$${p_1x+p_2}={p_1x}\circ  (x+p_2) (1)$$
$\Leftarrow {x+p_2}\in
 FAutT_2, {p_1x}\in
 FAutT_2 $(леми $1$,$2$).

 $\Rightarrow {p_1x+p_2}:0\rightarrow p_2$. Оскільки ${p_1x+p_2}\in FAutT_2 $, то $p_2\in Z_2^{\mathbb{Q}}$.
 За лемою $1$ ${x+p_2}\in FAutT_2$. Згідно з (1) ${p_1x}\in
 FAutT_2$. За лемою $2$ $p_1 \in Z_2^{\mathbb{Q}}$.

\end{proof}
\begin{theorem}
Автоморфізми $f(x)=(4k+1)  x+1 (k\in Z_2)$ -автоморфізми
максимального про-порядку.
\end{theorem}
\begin{proof}
$${(4k+1)x}=({(4k+1)  x},{(4k+1)x+2k})=$$
$$=({(4k+1)x},{(4k+1)x})\circ  (e,{x+2k})$$
 Автоморфізм вигляду $(a,a)$ належить коммутанту в $AutT_2$. ${x+2k}$ ,а відповідно
 і $(e,{x+2k})$
 належать коммутанту в $AutT_2$.

 $${(4k+1)x+1}={(4k+1)x}\circ  (x+1)$$
 ${x+1}$- максимального про-порядку, отже і ${(4k+1)x+1}$- максимального
 про-порядку.

\end{proof}
Означимо $(4k+1)^{\widehat{x}}$ , як $\chi_0:0\rightarrow 0$  в
рівнянні ${x+1}^{\chi}={(4k+1)x+1}$ . Має місце рівність
$$(4k+1)^x=4k  (4k+1)^{\widehat{x}}+1 \ \ \ \ \ \ \ (* )$$ де
$(4k+1)^x$ -функція, що продовжується з $\mathbb{Z} $ на $Z_2 $ по
неперервності в топології на $Z_2 $, оскільки функція
$\frac{(4k+1)^x-1}{4k}$ є автоморфізмом з $AutT_2$ і
$$( \frac{4k+1)^x-1}{4k} )^{-1}\circ  (x+1) \circ$$ $$\circ  ( \frac{(4k+1)^x-1}{4k} )=(4k+1)x+1$$ Звернемо увагу на те, що
$(4k+1)^x$ не задається автоморфізмом з $AutT_2$.

\begin{theorem}
Функції $f_1(x)=x+1$ та $f_2(x)=5x+1$ не спряжені в $FAutT_2$.
\end{theorem}

\begin{proof}
Дійсно, згідно з $(* )$ $5^x\in Z^q_2 \Leftrightarrow
5^{\widehat{x}}\in Z^q_2 $. Далі $5^{\widehat{x}}:1/3 \rightarrow
5^{\widehat{1/3}}.\  \sqrt[3]{5}$ не належить $Z^q_2 \Rightarrow
5^{\widehat{1/3}} $ не належить $Z^q_2 \Rightarrow
5^{\widehat{x}}:1/3\rightarrow 5^{\widehat{1/3}} $ не належить
$FAutT_2$. Згідно з лемою 3 $f_1(x)=x+1$ та $f_2(x)=5x+1$ не
спряжені в $FAutT_2$.
\end{proof}

\begin{theorem} Автоморфізми ${ax+1}$ та ${a^{-1}x+1}\ (a=4k+1, k\in Z^q_2,a\neq 1)$ не спряжені в
$FAutT_2$.
\end{theorem}
\begin{proof}
Множина функцій
$$\{\chi_k(x)=\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+1)}|k\in
Z_2\}\ \ \ (1)$$ містить всі розв'язки рівняння по невідомому
$\chi$
$$\chi^{-1}\circ  (ax+1)\circ  \chi=\frac{1}{a}x+1 \ \ \ (2)$$ і
тільки їх.

Покажемо, що $\chi_k(x)$ є розв'язком рівняння (2).
$$ \chi^{-1}(x)=\frac{-a^{k-1}x+a^{\widehat{k}}}{a^{k-1}((a-1)x-a)}\ ,$$
$$\chi_k^{-1}(x)\circ  (ax+1)\circ  \chi_k(x) =$$
$$=(\frac{-a^{k-1}x+a^{\widehat{k}}}{a^{k-1}((a-1)x-a)})\circ$$$$\circ
(ax+1)\circ (\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+1)})=$$ $$
=(a(\frac{-a^{k-1}x+a^{\widehat{k}}}{a^{k-1}((a-1)x-a)})+1) \circ
$$ $$\circ (\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+ 1)})=$$
$$=(\frac{-a^{k-2}x+a^{\widehat{k-1}}}{a^{k-2}((a-1)x-a)})\circ (\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+1)})=
$$ $$ \frac{(-x-a)\diagup ((a-1)x-a)}{-a\diagup ((a-1)x-a)}=\frac{-x-a}{-a}=\frac{1}{a}x+1.$$

Далі, якщо $\chi$ є розв'язком рівняння (2) і переводить
$\chi:0\rightarrow t, t\in Z_2$ (для рівняння (2) існує єдиний
$\chi$, такий, що $\chi:0\rightarrow t$, для фіксованого $t\in
Z_2$. Див.[3] ), то $\chi(x)=\chi_k(x),$ де
$k=log_a(a^{k-1}(a-1)t+1)$, тобто інших розв'язків, крім (1),
 немає.


 Автоморфізм $\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+1)}$
не є скінченостановим для $\forall k \in Z_2$ .


 Дійсно, має місце наступна рівність $$\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+1)}
 =(a^kx+a^{\widehat{k}})\circ (\frac{x}{px+q}) $$ де $p=(a-1)/a , q=1/a$.
 Далі, якщо автоморфізм $\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+1)}$ є скінченостановим,
  то ,за лемою 5, і автоморфізм $a^kx+a^{\widehat{k}}$  є скінченостановим,
   оскільки $\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+1)}$
  переводить кінець $...0000$ в квазіперіодичний,за теоремою 1 ,кінець
  $a^{\widehat{k}}/a^{k-1}$, а кінці $a^k,a^{\widehat{k}}$ та $a^{\widehat{k}}/a^{k-1}$
   є квазіперіодичними одночасно. А автоморфізм $\frac{x}{px+q}$ містить нескінчену кількість станів вигляду
$$\frac{x}{p2^tx+q},t \in \mathbb{Z}^+$$ тобто маємо протиріччя,
 і автоморфізм $\frac{a^kx+a^{\widehat{k}}}{a^{k-1}((a-1)x+1)}$ - нескінченостановий $\forall k \in Z_2$.


 Як наслідок, рівняння (2) не має
  розв'язків в $FAutT_2$.
\end{proof}
Звернемо увагу на те, що згідно з лемою 4 автоморфізми $a^{-1}x+1$
та $a^{-1}x-a^{-1}$ спряжені в $FAutT_2$. Тобто, згідно з теоремою
4 автоморфізми $ax+1$ та $a^{-1}x-a^{-1}$ не спряжені в $FAutT_2$,
хоча і мають однаковий зріст, оскільки
${ax+1}^{-1}={a^{-1}x-a^{-1}}$. Тобто має місце наступне
твердження:

\begin{theorem}
Група $FAutT_2$ є амбівалентною.
\end{theorem}
\begin{theorem}
Функції $f_1(x)=(4k_1+1)x+1$ та $f_2(x)=(4k_2+1)x+1 \ (k_1,k_2 \in
Z_2^{\mathbb{Q}})$ спряжені в $FAutT_2 \Leftrightarrow
4k_1+1=4k_2+1.$
\end{theorem}
\begin{proof}


  $ax+1,bx+1 (a=4k_1+1,b=4k_2+1\ k_1,k_2\in Z_2^{\mathbb{Q}}, \ (4k_1+1)\neq (4k_2+1)^{\pm 1})$ не
спряжені в $FAutT_2$.

  Дійсно, якщо автоморфізми $\alpha,\beta \in
FAutT_2$ спряжені в $FAutT_2$, то для всіх $p\in Z_2$ має місце
$(\alpha^p\in FAutT_2)\Leftrightarrow(\beta^p\in FAutT_2)$(згідно
з теоремою 4, ця умова не є достатньою). Далі, без обмеження
загальності $b\neq a^n ( n\in \mathbb{Z},n\neq \pm 1)$.

$\log_a((a-1)x+1)$ є бієкцією $Z_2\rightarrow Z_2$, як функція,
обернена до $a^{\widehat{x}}(a=4k+1,k,x\in Z_2)$.\

${(ax+1)}^t={(a^tx+a^{\widehat{t}})}(t\in Z_2)\ (** )$.

 За
теоремою Діріхле про наявність простих чисел в арифметичній
прогресії $\exists x\in \mathbb{Z} $,таке, що $c=(a-1)x+1$- просте
число, якого немає в розкладі $a$ та $b$. Тоді (згідно з лемою 5
та (** ) ) $(ax+1)^{\log_ac}\in FAutT_2$,оскільки $a^{\log_ac}=c$
є раціональним числом, а $(bx+1)^{\log_ac}$ не належить
$FAutT_2$,оскільки $b^{\log_ac}$ не є раціональним числом. Додаючи
теорему 4 отримаємо результат теореми.
\end{proof}


\section*{Висновки}

Сформулюємо відповідь на питання поставлене на початку статті.



 Скінченостанові автоморфізми максимального про-порядку, що задаються лінійними
 функціями $ax+c,\ bx+d\ (a,b,c,d\in Z_2)$ спряжені в $FAutT_2$ тоді і тільки тоді, коли
  $a=b$.
  \subsection{Розширення запасу лінійних функцій}
  На відміну від автоморфізмів $x+1, 5x+1, 9x+1,...$ автоморфізми $3x+1,7x+1...$ не є максимального про-порядку.
Для розширення запасу функцій введемо операцію $\bigoplus$ додавання за модулем 2.
\begin{theorem}
Автоморфізми $ f(x)=(4k+3)  x\oplus 1 (k\in Z_2)$ -автоморфізми максимального про-порядку.
\end{theorem}
\begin{proof}

 Автоморфізм вигляду $(a,a)$ належить коммутанту в $AutT_2$. ${x+2k}$ ,а відповідно
 і $(e,{x+2k})$
 належать коммутанту в $AutT_2$. З рівності$$(e,x+2k+1)\circ \sigma=(e,x+2k)\circ (e,x+1)\circ \sigma =(e,x+2k)\circ (x+1)$$
отримуємо, що $$(e,x+2k+1)\circ \sigma$$
-автоморфізм максимального про-порядку.

 Для $f(x)=(4k+3)  x\oplus 1$ маємо:
 $${(4k+3)x}=({(4k+3)x},{(4k+3)x+2k+1})
=({(4k+3)x},{(4k+3)x})\circ  (e,{x+2k+1})$$
  Отже $${(4k+3)x\oplus 1}={(4k+3)x}\circ  \sigma=({(4k+3)x},{(4k+3)x})\circ  ((e,{x+2k+1})\circ  \sigma)$$- автоморфізм максимального
 про-порядку.
\end{proof}
\begin{theorem}\label{sp1}
Функції $f_1(x)=(4k+1)x+1$ та $f_2(x)=-(4k+1)x\oplus 1 \ (k\in Z_2)$ спряжені в $FAutT_2$.

\end{theorem}
\begin{proof} Має місце рівність
$${(-x,x)}^{-1}\circ  {((4k+1)x+1)}\circ  {(-x,x)}={-(4k+1)x}\oplus
1.$$

 А оскільки ${-x}\in FAutT_2$ , то і ${(-x,x)}\in FAutT_2$.

\end{proof}
