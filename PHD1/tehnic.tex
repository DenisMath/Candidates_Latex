\chapter{Техніка}
\section{Портрети}
%\subsection{Необхідні визначення}
Автоморфізм задається розміченним деревом в такий спосіб. Якщо автоморфізм переставляє вершини наступного рівня, що суміжні з даною вершиною, то відмітимо цю вершину 1-цею, якщо ні, то 0-лем. Таке представлення автоморфізма називається портретом.

 При такому представленні автоморфізму $a$ кожному
  кінцю $x$ відповідає послідовність цифр $x_a$ розмічених вершин
   цього кінця, причому кінець
 $x$ під дією автоморфізма $a$ переходить в кінець $x\oplus x_a$
  (під операцією $\oplus$ розуміється покоординатне додавання по модулю 2).


Для опису множення на представленні автоморфізмів дерева портретами знадобляться дві конструкції: додавання портретів за модулем 2 та дія на портрет автоморфізмом дерева.

Множина портретів з операцією додавання за модулем 2 відповідних вершин утворює абелеву групу. Нейтральним елементом цієї групи буде портрет з 0 на всіх вершинах, обернений до елементу групи співпадає з самим елементом.

\begin{center}
\includegraphics[scale=0.8]{SumTr.eps}
\end{center}
Портрет добутку автоморфізмів $a\circ b$ будується наступним чином. Дієм на портрет b автоморфізмом, оберненим до a. Отриманий таким чином новий портрет додаємо по модулю 2 до портрету автоморфізму a.



\begin{center}
\includegraphics[scale=0.5]{MultTree1.eps}
\end{center}

При множенні портретів розмітка кінців дерева змінюється наступним чином:
$$x_{a\circ b}=x_a\oplus (x \oplus x_a)_b$$
Для оберненого до $a$ автоморфізма $a^{-1}$ маємо:
$$(x\oplus x_a)_{a^{-1}}=x_a$$


\section{Алгебраїчний запис}
%\subsection{Необхідні визначення}
 Алгебраїчний запис зручно використовувати для множеня автоморфізмів.


 В алгебраїчному запису автоморфізм дерева буде виглядати, як $(a,b)$ або як $(a,b)\circ \sigma$.


  Автоморфізм вигляду $(a,b)$
  діє на праве для кореня піддерево автоморфізмом a, на ліве - автоморфізмом b, залишаючи суміжні
   з коренем вершини на місці.
Автоморфізм вигляду $(a,b)\circ \sigma$  діє на праве для кореня піддерево автоморфізмом a, на ліве - автоморфізмом b,та переставляє суміжні з коренем вершини.


Множення автоморфізмів відбувається наступним чином:
$$(a,b)\circ (c,d)=(a\circ c,b\circ d)$$
$$(a,b)\circ ((c,d)\circ \sigma)=(a\circ c,b\circ d)\circ \sigma$$
$$((a,b)\circ \sigma)\circ (c,d)=(a\circ d,b\circ c)\circ \sigma$$
$$((a,b)\circ \sigma)\circ ((c,d)\circ \sigma)=(a\circ d,b\circ c)$$
Також зручно записувати обернений до автоморфізму дерева:
$$(a,b)^{-1}=(a^{-1},b^{-1})$$
$$((a,b)\circ \sigma)^{-1}=\sigma \circ (a^{-1},b^{-1})=(b^{-1},a^{-1})\circ \sigma$$

Крім цього за допомогою алгебраїчного запису однозначно визначаються скінченостанові автоморфізми. Наприклад  $adding \ machine$ задається наступним співвідношенням:
$$\varepsilon=(id,\varepsilon)\circ \sigma$$
$$id=(id,id)$$
Квадрат $adding \ machine$ має 3 стани $\varepsilon$ , $\varepsilon^2$ та $id$:
$$\varepsilon^2=(\varepsilon,\varepsilon)$$
$$\varepsilon=(id,\varepsilon)\circ \sigma$$
$$id=(id,id)$$
За допомогою цієї техніки опишемо $\varepsilon^k$:
$$\varepsilon^{-1}=(\varepsilon^{-1},id)\circ \sigma$$
$$\varepsilon^3=\varepsilon^2 \circ \varepsilon=(\varepsilon,\varepsilon) \circ (id,\varepsilon)\circ \sigma=(\varepsilon,\varepsilon^2)\circ \sigma $$
$$\varepsilon^{2k}=(\varepsilon^k,\varepsilon^k) $$
 $$\varepsilon^{2k+1}=(\varepsilon^k,\varepsilon^k)\circ \varepsilon= (\varepsilon^k,\varepsilon^k)
 \circ (id,\varepsilon)\circ \sigma=(\varepsilon^k,\varepsilon^{k+1})\circ \sigma $$

\section{Автомати}
%\subsection{Необхідні визначення}




Автомат, що задає автоморфізм дерева зручно записувати у вигляді орієнтованого графа,
 якій складається з вершин двох типів $\sigma$ та $id$, та множини орієнтованих ребер двох типів,
  помічених 0 та 1, причому з кожної вершини виходить рівно по одному ребру кожного типу.


   Вершини в представленні автомата графом називаються станами автомату. Одна вершина відмічена,
    як ініціальний стан.

    На малюнку наведені автомати для автоморфізму дерева $\varepsilon (adding \ machine)$, $\varepsilon^{-1}$ та тотожнього автоморфізму $id$.

    \begin{center}
\includegraphics[scale=0.5]{Auto.eps}
\end{center}

Автомат діє на кінцях двійкого дерева у такий спосіб.

 Помістимо
першу цифру двійкового розкладу кінця в ініціальний стан автомату.
Якщо цей стан має тип $id$, то автомат повертає цифру, не змінюючи
 її, якщо стан має тип $\sigma$, то  автомат повертає протилежну цифру(0 та 1- протилежні).
 \begin{center}
\includegraphics[scale=1.0]{Autwork.eps}
\end{center}


\section{Функції}
%\subsection{Необхідні визначення}

%\begin{center}
%\includegraphics[scale=0.4]{DM.eps}
%\end{center}
 Ототожнюючи двійкове кодування кінця дерева з двійковим кодуванням
2-адичного числа отримаємо представлення автоморфізма функцією на
$Z_2$. Наприклад $adding \  machine$ при такому представленні
задається функцією $f(x)=x+1$.

Кожен автоморфізм дерева $\alpha$ задає
функцію $f_\alpha$ за правилом: якщо автоморфізм $\alpha$ переводить кінець x в кінець
y, то $f_\alpha(x)=y$.

Але не кожна функція є автоморфізмом дерева. Для
того, що б функція задавала автоморфізм необхідно, що б ця функція
пару кінців з однаковим початком переводила в пару кінців з
однаковим початком тієї ж самої довжини. Функція $f(x)=2x$
переводить пару ...1111 та ...0000 в пару ...1110 та ...0000
відповідно. Перша пара має спільний початок довжини 0, друга  -
довжини 1, тобто функція  $f(x)=2x$ не є автоморфізмом дерева.


Втім клас функцій, що є автоморфізмами дерева є досить широким.
Має місце наступне твердження:
 \begin{theorem}Лінійні функції вигляду
$f(x)=ax+b, a=2k+1, a,b,k \in Z_2$ є автоморфізмами дерева.
\end{theorem}


\begin{proof}
Те, що 2-адичні послідовності x та y мають спільний
початок довжини k, рівносильно тому, що послідовність $x-y$ має
наступний вигляд: ...t10...00, де на початку послідовності маємо k
нулів. Але для послідовностей $ax+b$ та $ay+b$  різниця має вигляд
$a(x-y)$, а оскільки а - непарне 2-адичне число, то
$a(x-y)=...t'10...00$, де на початку послідовності маємо k нулів ,
тобто послідовності $ax+b$ та $ay+b$ також мають спільний початок
довжини $k$.
\end{proof}
Добутку автоморфізмів дерева відповідає суперпозиція відповідних функцій.
І для автоморфізмів, і для функцій оберемо ліву дію.
$$\varepsilon^2=\varepsilon\circ \varepsilon=(x+1)\circ (x+1)=(x+1)+1=x+2$$
$$(3x+1)\circ (x+2)=(3x+1)+2=3x+3$$
$$(x+2)\circ (3x+1)=3(x+2)+1=3x+7$$
\begin{lemma}
Для функції $f(x)=ax+b, a=2k+1, a,b,k \in Z_2$ маємо $f^{-1}(x)=\frac{1}{a}(x-b)$.
\end{lemma}
\begin{proof}
$$(ax+b)\circ (\frac{1}{a}(x-b))=\frac{1}{a}((ax+b)-b)=x$$
\end{proof}
Як можна побачити, операція суперпозиції функцій, взагалі кажучи, не є комутативною. Але для деяких,
 спеціальним способом відібраних функцій комутативність має місце.
\begin{lemma}
Множина функцій $f(x)=x+p, \ p\in Z_2$ є абелевою групою.
\end{lemma}
\begin{proof}
$$(x+p)^{-1}=x-p$$
$$(x+p_1)\circ(x+p_2)=(x+p_2)\circ(x+p_1)=x+p_1+p_2$$
\end{proof}


\section{Орієнтовані графи}
%\subsection{Необхідні визначення}


Орієнтовані графи.
Для автоморфізма $\sigma$, що що переставляє вершини 1-го рівня, а на піддеревах, що виходять з цих вершин, діє тотожньо, орієнтовний граф виглядає наступним чином:

\begin{center}
\includegraphics[scale=0.8]{Orsigm.eps}
\end{center}

Для $adding \ machine$ маємо орієнтований граф вигляду:

\begin{center}
\includegraphics[scale=0.4]{Orad.eps}
\end{center}

Для тотожнього автоморфізму $id$ маємо орієнтований граф вигляду:

\begin{center}
\includegraphics[scale=0.5]{Orid.eps}
\end{center}

 Орієнтований граф автоморфізму індукує орієнтовані графи на вершинах, що належать одному рівню.
По орієнтованому графу автоморфізма дерева легко побудувати дерево цикельного типу автоморфізму, яке означається наступним чином: вершинами n-го рівня цього дерева є цикли відповідного орієнтованого графа. Пара вершин дерева типу автоморфізма з'єднана ребром, якщо існує пара суміжних вершин з відповідних ціклів.
\begin{center}
\includegraphics[scale=0.9]{Type_tree1.eps}
\end{center}

Тип автоморфізму відповідає цикельному типу елемента в групі підстановок $S_n$. Побудуємо дерева типу для деяких автоморфізмів.

 Для $adding \ machine$ $\varepsilon$.
  Оскільки на кожному рівні маємо тільки один цикл, то дерево типу є ланцюгом:
\begin{center}
\includegraphics[scale=0.4]{AMgraph.eps}
\end{center}
 Для квадрату $adding \ machine$ $\varepsilon^2$, маємо два цикли, оскільки $$\varepsilon^2=(\varepsilon,\varepsilon)$$
 тобто дерево типу для $\varepsilon^2$ містить два ланцюги:
\begin{center}
\includegraphics[scale=0.6]{Gr(x+2).eps}
\end{center}
Для $x\oplus 1$ всі цикли мають довжину 2.

Дійсно, послідовність вигляду $...x_3x_2x_10$ переходить в послідовність вигляду $...x_3x_2x_11$,і ,навпаки,послідовність вигляду $...x_3x_2x_11$ переходить в послідовність вигляду $...x_3x_2x_10$.

 Дерево типу для автоморфізму $f(x)=x\oplus 1$
має вигляд:

\begin{center}
\includegraphics[scale=0.5]{Typesigm.eps}
\end{center}



Для тотожнього автоморфізму $id$,очевидно, всі цикли мають довжину 1, отже дерево типу співпадає з $T_2$:


\begin{center}
\includegraphics[scale=0.5]{Typeid.eps}
\end{center}


\section{Зв"язок}
%\subsection{Необхідні визначення}
 Опишемо зв"язок між  представленнями, побудованими в попередніх розділах.
  На малюнку маємо представлення adding machine у п"яти вищезгаданих мовах:
\begin{center}
\includegraphics[scale=0.8]{5mov.eps}
\end{center}
Побудуємо по функції $f(x)=3x$ її алгебраїчний запис.

Подіємо на 2-адичні послідовністі $ x0$ та $x1$ функцією $f$(де x - це 2-адичний розклад числа x).
$$x0=2x$$ $$ 3(x0)=3(2x)=2(3x)=(3x)0$$
$$x1=2x+1$$ $$ 3(x1)=3(2x+1)=2(3x+1)+1=(3x+1)1$$
Тобто $$3x=(3x,3x+1).$$

За допомогою алгебраїчного запису представимо автоморфізми у автоматному вигляді.
Для $adding \  machine$ $$x+1=(id,x+1)\circ \sigma$$ тобто маємо 2-становий автомат:

 \begin{center}
\includegraphics[scale=0.8]{alg_to_auto.eps}
\end{center}
Для функції $f(x)=3x$
$$3x=(3x,3x+1)$$
$$3x+1=3x\circ (x+1)=(3x,3x+1)\circ (id,x+1)\circ \sigma=(3x,3x+2)\circ \sigma$$
$$3x+2=3x\circ (x+2)=(3x,3x+1)\circ (x+1,x+1)=(3x+1,3x+2)\circ \sigma$$
Маємо 3 стани $3x,3x+1$ та $3x+2$.

 Стани $3x$ та $3x+2$ мають тип $id$, стан $3x+1$ має тип $\sigma$:

\begin{center}
\includegraphics[scale=0.8]{3x.eps}
\end{center}

 Змінюючи ініціальний стан отримуємо автомати для функцій $f(x)=3x+1$ та $f(x)=3x+2$:


 \begin{center}
\includegraphics[scale=0.8]{3x+1.eps}
\end{center}
\begin{center}
\includegraphics[scale=0.8]{3x+2.eps}
\end{center}
По функціональному представленню автоморфізму $a$ $$a:x\rightarrow f(x)$$
побудуємо орієнтований граф. Кожен цикл цього графа буде мати вигляд
$$...\rightarrow f^{-1}(x^{(1)}_0)\rightarrow f(x^{(1)}_0)\rightarrow f^1(x^{(1)}_0)\rightarrow f^2(x^{(1)}_0)...$$
$$...\rightarrow f^{-1}(x^{(2)}_0)\rightarrow f(x^{(2)}_0)\rightarrow f^1(x^{(2)}_0)\rightarrow f^2(x^{(2)}_0)...$$
$$...................$$
 $$...\rightarrow f^{-1}(x^{(k)}_0)\rightarrow f(x^{(k)}_0)\rightarrow f^1(x^{(k)}_0)\rightarrow f^2(x^{(k)}_0)...$$
 $$...................$$
  де кінці $x^{(k_1)}_0$ та $x^{(k_2)}_0$ для $k_1\neq k_2$ належать різним циклам,
   тобто не існує $p\in Z_2$, такого, що $$f^p(x^{(k_1)}_0)=x^{(k_2)}_0$$
   Наприклад, для автоморфізма вигляду $f(x)=5x+1$ маємо єдиний цикл вигляду:
   $$...\rightarrow -\frac{1}{5}\rightarrow 0\rightarrow 1\rightarrow 6\rightarrow 31\rightarrow 0...$$ 